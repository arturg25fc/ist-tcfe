close all
clear all

%%NODAL ANALYSIS
%Please introduce values in kOhm (resistances) / mS (conductances), V (voltages) and mA (currents)

G1= 1./1.0240888586490353;
G2=1./2.077743916695854;
G3=1./3.085823508104019;
G4=1./4.1834915928511425;
G5=1./3.094732956849807;
G6=1./2.048970926825776;
G7=1./1.0225774446662013;
Va=5.040990939839293;
Id=1.0179673375046598;
Kb=7.208307865585887;
Kc=8.078580599523491;
BN=[Va,0,0,0,0,Id,0]';
MN=[1,0,0,-1,0,0,0;-G1,G1+G2+G3,-G2,0,-G3,0,0;0,-G2-Kb,G2,0,Kb,0,0;G1,-G1,0,G4+G6,-G4,0,-G6;0,0,0,-Kc*G6,1,0,Kc*G6;0,Kb,0,0,-G5-Kb,G5,0;0,0,0,-G6,0,0,G6+G7];
x=MN\BN;
printf("%f & %f & %f & %f & %f & %f & %f \\\\\n",x(1),x(2),x(3),x(4),x(5),x(6),x(7));
